<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>beGAK.com - Profil</title>
    <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="profil.css">
    <script>
        // Oturum kontrolü
        window.onload = function() {
            const authToken = localStorage.getItem('authToken');
            const userData = JSON.parse(localStorage.getItem('user') || '{}');
            
            // Eğer authToken yoksa veya userData boşsa, login sayfasına yönlendir
            if (!authToken || !userData.studentNumber) {
                window.location.href = '../login/login_screen.html';
                return;
            }
        }
    </script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="brand">
            <div class="brand-logo">bG</div>
            <a href="../anasayfa/anasayfa_screen.html" class="brand-name">beGAK.com</a>
        </div>
        <div class="nav-links">
            <a href="../anasayfa/anasayfa_screen.html"><i class="fas fa-home"></i> Ana Sayfa</a>
            <a href="../sosyal_etkinlikler/sosyal_etkinlikler_screen.html"><i class="fas fa-calendar-alt"></i> Sosyal Etkinlikler</a>
            <a href="../profil/profil_screen.html" class="active"><i class="fas fa-user"></i> Profil</a>
            <a href="../mesajlar/mesajlar_screen.html"><i class="fas fa-envelope"></i> Mesajlar</a>
            <a href="../kulupler/kulupler_screen.html"><i class="fas fa-users"></i> Kulüpler</a>
            <a href="#" onclick="return handleLogout()"><i class="fas fa-sign-out-alt"></i> Çıkış Yap</a>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Profile Sidebar -->
        <div class="profile-sidebar">
            <!-- Profile Card -->
            <div class="profile-card">
                <div class="profile-photo-container">
                    <div class="profile-photo" id="profilePhotoPreview">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="photo-edit-btn" onclick="document.getElementById('photoInput').click()">
                        <i class="fas fa-camera"></i>
                    </div>
                    <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="previewProfilePhoto(event)">
                </div>
                <h2 class="profile-name" id="profileName">Kullanıcı Adı</h2>
                <p class="profile-role" id="profileRole">Öğrenci</p>
                <div class="profile-actions">
                    <a href="edit_profile_screen.html" class="btn-edit">
                        <i class="fas fa-edit"></i> Profili Düzenle
                    </a>
                </div>
            </div>

            <!-- Information Section -->
            <div class="sidebar-info">
                <div class="sidebar-info-item">
                    <div class="sidebar-info-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="sidebar-info-content">
                        <div class="sidebar-info-label">E-posta</div>
                        <div class="sidebar-info-value" id="profileEmail">kullanici@firat.edu.tr</div>
                    </div>
                </div>
                
                <div class="sidebar-info-item">
                    <div class="sidebar-info-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <div class="sidebar-info-content">
                        <div class="sidebar-info-label">Telefon</div>
                        <div class="sidebar-info-value" id="profilePhone">+90 555 123 4567</div>
                    </div>
                </div>
                
                <div class="sidebar-info-item">
                    <div class="sidebar-info-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="sidebar-info-content">
                        <div class="sidebar-info-label">Bölüm</div>
                        <div class="sidebar-info-value" id="profileDepartment">Yazılım Mühendisliği</div>
                    </div>
                </div>
                
                <div class="sidebar-info-item">
                    <div class="sidebar-info-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="sidebar-info-content">
                        <div class="sidebar-info-label">Mezuniyet Yılı</div>
                        <div class="sidebar-info-value" id="profileGraduationYear">Belirtilmemiş</div>
                    </div>
                </div>
                
                <div class="sidebar-info-item">
                    <div class="sidebar-info-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="sidebar-info-content">
                        <div class="sidebar-info-label">Kayıt Tarihi</div>
                        <div class="sidebar-info-value" id="profileJoinDate">15 Eylül 2023</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Feed - Orta Kısım (Gönderiler) -->
        <div class="profile-feed">
            <!-- Yeni Gönderi Oluşturma -->
            <div class="new-post-card">
                <div class="new-post-header">
                    <div class="new-post-avatar">
                        <img id="userAvatar" src="" alt="Kullanıcı Fotoğrafı">
                    </div>
                    <div class="new-post-input-wrapper">
                        <textarea class="new-post-input" placeholder="Ne düşünüyorsun?"></textarea>
                    </div>
                </div>
                <div class="new-post-actions">
                    <div class="new-post-tools">
                        <div class="new-post-tool" title="Fotoğraf Ekle">
                            <i class="fas fa-image"></i>
                        </div>
                        <div class="new-post-tool" title="Video Ekle">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="new-post-tool" title="Dosya Ekle">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="new-post-tool" title="Konum Ekle">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                    </div>  
                    <button class="new-post-submit">Paylaş</button>
                </div>
            </div>

            <!-- Örnek Gönderi 1 -->
            <div class="post-card">
                <div class="post-header">
                    <div class="post-user-photo">
                        <img id="post1UserPhoto" src="" alt="Kullanıcı Fotoğrafı">
                    </div>
                    <div class="post-user-info">
                        <span class="post-username" id="profileName2">Ad Soyad</span>
                        <span class="post-time">2 saat önce</span>
                    </div>
                    <div class="post-options">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="post-content">
                    <div class="post-text">
                        Bugün Yazılım Mühendisliği kulübünün düzenlediği etkinliğe katıldım. Harika bir deneyimdi!
                    </div>
                    <div class="post-image">
                        <img src="https://picsum.photos/600/400?random=1" alt="Gönderi Görseli">
                    </div>
                    <div class="post-tags">
                        <span class="post-tag">#YazılımMühendisliği</span>
                        <span class="post-tag">#KulübEtkinlikleri</span>
                    </div>
                    <div class="post-attachment">
                        <div class="attachment-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="attachment-info">
                            <div class="attachment-name">EtkinlikRaporu.pdf</div>
                            <div class="attachment-size">1.2 MB</div>
                        </div>
                        <div class="attachment-download">
                            <i class="fas fa-download"></i>
                        </div>
                    </div>
                </div>
                <div class="post-actions">
                    <div class="post-action">
                        <i class="fas fa-thumbs-up"></i>
                        <span>23 Beğeni</span>
                    </div>
                    <div class="post-action">
                        <i class="fas fa-comment"></i>
                        <span>8 Yorum</span>
                    </div>
                    <div class="post-action">
                        <i class="fas fa-share"></i>
                        <span>Paylaş</span>
                    </div>
                </div>
                <div class="post-comments">
                    <div class="post-comment">
                        <div class="comment-avatar">
                            <img src="https://picsum.photos/100/100?random=2" alt="Kullanıcı Avatarı">
                        </div>
                        <div class="comment-content">
                            <div class="comment-username">Mehmet Demir</div>
                            <div class="comment-text">Çok güzel görünüyor! Bir sonraki etkinliğe ben de geleceğim.</div>
                            <div class="comment-time">1 saat önce</div>
                        </div>
                    </div>
                    <div class="post-comment">
                        <div class="comment-avatar">
                            <img src="https://picsum.photos/100/100?random=3" alt="Kullanıcı Avatarı">
                        </div>
                        <div class="comment-content">
                            <div class="comment-username">Ayşe Kaya</div>
                            <div class="comment-text">Hangi konular tartışıldı? Biraz bilgi verebilir misin?</div>
                            <div class="comment-time">40 dakika önce</div>
                        </div>
                    </div>
                </div>
                <div class="post-comment-form">
                    <div class="comment-avatar-small">
                        <img id="commentUserPhoto1" src="" alt="Kullanıcı Avatarı">
                    </div>
                    <div class="comment-input-wrapper">
                        <input type="text" class="comment-input" placeholder="Yorum yaz...">
                        <button class="comment-submit">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Örnek Gönderi 2 -->
            <div class="post-card">
                <div class="post-header">
                    <div class="post-user-photo">
                        <img id="post2UserPhoto" src="" alt="Kullanıcı Fotoğrafı">
                    </div>
                    <div class="post-user-info">
                        <span class="post-username" id="profileName3">Ad Soyad</span>
                        <span class="post-time">Dün</span>
                    </div>
                    <div class="post-options">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="post-content">
                    <div class="post-text">
                        Veri Yapıları ve Algoritmalar dersindeki final projemi tamamladım! 🎉
                    </div>
                    <div class="post-tags">
                        <span class="post-tag">#VeriYapıları</span>
                        <span class="post-tag">#Algoritma</span>
                        <span class="post-tag">#Programlama</span>
                    </div>
                    <div class="post-attachment">
                        <div class="attachment-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="attachment-info">
                            <div class="attachment-name">VeriYapılarıFinalProjesi.pdf</div>
                            <div class="attachment-size">2.4 MB</div>
                        </div>
                        <div class="attachment-download">
                            <i class="fas fa-download"></i>
                        </div>
                    </div>
                </div>
                <div class="post-actions">
                    <div class="post-action liked">
                        <i class="fas fa-thumbs-up"></i>
                        <span>47 Beğeni</span>
                    </div>
                    <div class="post-action">
                        <i class="fas fa-comment"></i>
                        <span>12 Yorum</span>
                    </div>
                    <div class="post-action">
                        <i class="fas fa-share"></i>
                        <span>Paylaş</span>
                    </div>
                </div>
                <div class="post-comments">
                    <div class="post-comment">
                        <div class="comment-avatar">
                            <img src="https://picsum.photos/100/100?random=4" alt="Kullanıcı Avatarı">
                        </div>
                        <div class="comment-content">
                            <div class="comment-username">Prof. Dr. Ahmet Yılmaz</div>
                            <div class="comment-text">Tebrikler! Çok başarılı bir proje olmuş. Özellikle ikili ağaç implementasyonu çok etkileyici.</div>
                            <div class="comment-time">Dün</div>
                        </div>
                    </div>
                    <div class="post-comment">
                        <div class="comment-avatar">
                            <img src="https://picsum.photos/100/100?random=5" alt="Kullanıcı Avatarı">
                        </div>
                        <div class="comment-content">
                            <div class="comment-username">Burak Kaya</div>
                            <div class="comment-text">Benimle paylaşabilir misin? Benim de projeme yardımcı olabilir.</div>
                            <div class="comment-time">Dün</div>
                        </div>
                    </div>
                </div>
                <div class="post-comment-form">
                    <div class="comment-avatar-small">
                        <img id="commentUserPhoto2" src="" alt="Kullanıcı Avatarı">
                    </div>
                    <div class="comment-input-wrapper">
                        <input type="text" class="comment-input" placeholder="Yorum yaz...">
                        <button class="comment-submit">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Örnek Gönderi 3 - Fotoğraf Galerisi -->
            <div class="post-card">
                <div class="post-header">
                    <div class="post-user-photo">
                        <img id="post3UserPhoto" src="" alt="Kullanıcı Fotoğrafı">
                    </div>
                    <div class="post-user-info">
                        <span class="post-username" id="profileName4">Ad Soyad</span>
                        <span class="post-time">Geçen hafta</span>
                    </div>
                    <div class="post-options">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="post-content">
                    <div class="post-text">
                        Robotik Kulübü'nün düzenlediği Teknoloji Festivali'nden kareler 🤖 Harika bir deneyimdi!
                    </div>
                    <div class="post-gallery">
                        <div class="gallery-item gallery-main">
                            <img src="https://picsum.photos/800/450?random=10" alt="Festival Ana Görseli">
                        </div>
                        <div class="gallery-item">
                            <img src="https://picsum.photos/400/300?random=11" alt="Festival Görseli 1">
                        </div>
                        <div class="gallery-item">
                            <img src="https://picsum.photos/400/300?random=12" alt="Festival Görseli 2">
                        </div>
                    </div>
                </div>
                <div class="post-actions">
                    <div class="post-action">
                        <i class="fas fa-thumbs-up"></i>
                        <span>89 Beğeni</span>
                    </div>
                    <div class="post-action">
                        <i class="fas fa-comment"></i>
                        <span>15 Yorum</span>
                    </div>
                    <div class="post-action">
                        <i class="fas fa-share"></i>
                        <span>Paylaş</span>
                    </div>
                </div>
                <div class="post-comments">
                    <div class="post-comment">
                        <div class="comment-avatar">
                            <img src="https://picsum.photos/100/100?random=6" alt="Kullanıcı Avatarı">
                        </div>
                        <div class="comment-content">
                            <div class="comment-username">Deniz Şahin</div>
                            <div class="comment-text">Bu yılki festival gerçekten muhteşemdi! Özellikle drone yarışması çok heyecanlıydı.</div>
                            <div class="comment-time">Geçen hafta</div>
                        </div>
                    </div>
                    <div class="post-comment">
                        <div class="comment-avatar">
                            <img src="https://picsum.photos/100/100?random=7" alt="Kullanıcı Avatarı">
                        </div>
                        <div class="comment-content">
                            <div class="comment-username">Elif Yılmaz</div>
                            <div class="comment-text">Bir sonraki festivalde ben de katılmak istiyorum. Katılım koşulları nelerdi?</div>
                            <div class="comment-time">Geçen hafta</div>
                        </div>
                    </div>
                </div>
                <div class="post-comment-form">
                    <div class="comment-avatar-small">
                        <img id="commentUserPhoto3" src="" alt="Kullanıcı Avatarı">
                    </div>
                    <div class="comment-input-wrapper">
                        <input type="text" class="comment-input" placeholder="Yorum yaz...">
                        <button class="comment-submit">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Details - Sağ Kenar -->
        <div class="profile-details">
            <!-- Biyografi -->
            <div class="content-card">
                <h3 class="section-title"><i class="fas fa-user-edit"></i> Biyografi</h3>
                
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-label">Hakkımda</div>
                        <div class="info-value" id="profileBio">Henüz bir biyografi eklenmemiş.</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-label">İlgi Alanları</div>
                        <div class="info-value" id="profileInterests">Henüz ilgi alanı eklenmemiş.</div>
                    </div>
                </div>
            </div>
            
            <!-- Kulüpler Bölümü -->
            <div class="content-card">
                <h3 class="section-title"><i class="fas fa-users"></i> Üye Olduğu Kulüpler</h3>
                
                <div class="clubs-grid">
                    <div class="club-card">
                        <div class="club-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="club-name">Yazılım Kulübü</div>
                    </div>
                    
                    <div class="club-card">
                        <div class="club-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="club-name">Robotik Kulübü</div>
                    </div>
                    
                    <div class="club-card">
                        <div class="club-icon">
                            <i class="fas fa-paint-brush"></i>
                        </div>
                        <div class="club-name">Tasarım Kulübü</div>
                    </div>
                </div>
            </div>
            
            <!-- Aktiviteler Bölümü -->
            <div class="content-card">
                <h3 class="section-title"><i class="fas fa-calendar-week"></i> Son Aktiviteler</h3>
                
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-comment-alt"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-label">Etkinlik</div>
                        <div class="info-value">Yazılım Kulübü'nün "Web Geliştirme" etkinliğine katıldı.</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-certificate"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-label">Başarı</div>
                        <div class="info-value">Python programlama kursunu tamamladı.</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <div class="info-icon">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-label">Üyelik</div>
                        <div class="info-value">Veri Bilimi Topluluğu'na katıldı.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sayfa yüklendiğinde kullanıcı bilgilerini yükle
        document.addEventListener('DOMContentLoaded', async function() {
            // Oturum kontrolü
            const isLoggedIn = await checkSession();
            if (!isLoggedIn) {
                window.location.href = '../login/login_screen.html';
                return;
            }

            // Kullanıcı bilgilerini al
            const userData = JSON.parse(localStorage.getItem('user') || '{}');
            if (!userData.studentNumber) {
                window.location.href = '../login/login_screen.html';
                return;
            }

            // Profil bilgilerini yükle
            loadProfile(userData.email.split('@')[0]);
            
            // Kullanıcı fotoğraflarını yükle
            loadUserPhotos();
        });

        // Kullanıcı fotoğraflarını yükle
        function loadUserPhotos() {
            const userData = JSON.parse(localStorage.getItem('user') || '{}');
            const userPhoto = userData.photo || '';
            
            // Avatar fotoğraflarını güncelle
            const avatarElements = [
                document.getElementById('userAvatar'),
                document.getElementById('post1UserPhoto'),
                document.getElementById('post2UserPhoto'),
                document.getElementById('post3UserPhoto'),
                document.getElementById('commentUserPhoto1'),
                document.getElementById('commentUserPhoto2'),
                document.getElementById('commentUserPhoto3')
            ];
            
            avatarElements.forEach(element => {
                if (element) {
                    if (userPhoto) {
                        element.src = userPhoto;
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                        element.parentElement.style.background = 'linear-gradient(135deg, var(--primary-color), var(--accent-color))';
                        element.parentElement.textContent = userData.username?.charAt(0).toUpperCase() || 'U';
                    }
                }
            });
            
            // Profil adını gönderilerde güncelle
            const profileNames = [
                document.getElementById('profileName2'),
                document.getElementById('profileName3'),
                document.getElementById('profileName4')
            ];
            
            profileNames.forEach(element => {
                if (element) {
                    element.textContent = userData.firstName && userData.lastName 
                        ? `${userData.firstName} ${userData.lastName}` 
                        : userData.username || 'Ad Soyad';
                }
            });
        }

        // Profil bilgilerini yükle
        async function loadProfile(username) {
            try {
                const profile = await getProfile(username);
                updateProfileUI(profile);
            } catch (error) {
                console.error('Profil yüklenirken hata:', error);
            }
        }

        // Profil bilgilerini arayüze yansıt
        function updateProfileUI(profile) {
            const profilePhoto = document.getElementById('profilePhotoPreview');
            if (profile.photo) {
                profilePhoto.style.backgroundImage = `url(${profile.photo})`;
                profilePhoto.style.backgroundSize = 'cover';
                profilePhoto.style.backgroundPosition = 'center';
            } else {
                profilePhoto.style.backgroundImage = 'none';
                profilePhoto.innerHTML = '<i class="fas fa-user"></i>';
            }
            document.getElementById('profileName').textContent = profile.username;
            document.getElementById('profileRole').textContent = profile.title || 'Öğrenci';
            document.getElementById('profileEmail').textContent = profile.email;
            document.getElementById('profilePhone').textContent = profile.phone || 'Belirtilmemiş';
            document.getElementById('profileDepartment').textContent = profile.department || 'Belirtilmemiş';
            document.getElementById('profileGraduationYear').textContent = profile.graduationYear || 'Belirtilmemiş';
            document.getElementById('profileJoinDate').textContent = formatDate(profile.joinDate);
            document.getElementById('profileBio').textContent = profile.bio || 'Henüz bir biyografi eklenmemiş.';
            document.getElementById('profileInterests').textContent = profile.interests || 'Henüz ilgi alanı eklenmemiş.';
            
            // Profil istatistiklerini güncelle
            const statValues = document.querySelectorAll('.stat-value');
            if(statValues.length >= 3) {
                statValues[0].textContent = profile.stats.posts;
                statValues[1].textContent = profile.stats.followers;
                statValues[2].textContent = profile.stats.following;
            }

            // Kulüpleri yükle
            const clubsGrid = document.querySelector('.clubs-grid');
            clubsGrid.innerHTML = '';
            
            if (profile.clubs && profile.clubs.length > 0) {
                profile.clubs.forEach(club => {
                    const clubCard = document.createElement('div');
                    clubCard.className = 'club-card';
                    clubCard.innerHTML = `
                        <div class="club-icon">
                            <i class="${club.icon || 'fas fa-users'}"></i>
                        </div>
                        <div class="club-name">${club.name}</div>
                    `;
                    clubsGrid.appendChild(clubCard);
                });
            } else {
                clubsGrid.innerHTML = '<p>Henüz hiç kulübe üye değilsiniz.</p>';
            }
        }

        // Tarih formatı
        function formatDate(dateString) {
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            return new Date(dateString).toLocaleDateString('tr-TR', options);
        }

        // Çıkış yapma
        function handleLogout() {
            // Çıkış için onay al
            if (confirm("Çıkış yapmak istediğinize emin misiniz?")) {
                // Kullanıcı onayladıysa çıkış işlemleri yap
                localStorage.removeItem('authToken');
                localStorage.removeItem('user');
                window.location.href = '../login/login_screen.html';
                return true;
            }
            // Kullanıcı onaylamadıysa hiçbir şey yapma
            return false;
        }

        /* Backend Fonksiyonları (simüle edilmiş) */

        // Oturum kontrolü
        async function checkSession() {
            return !!localStorage.getItem('authToken');
        }

        // Profil bilgilerini getir
        async function getProfile(username) {
            // localStorage'dan kullanıcı bilgilerini al
            const userData = JSON.parse(localStorage.getItem('user') || '{}');
            
            // Bölüm seçeneklerini tanımla
            const departments = {
                'bilgisayar': 'Bilgisayar Mühendisliği',
                'yazilim': 'Yazılım Mühendisliği',
                'elektrik': 'Elektrik-Elektronik Mühendisliği',
                'makine': 'Makine Mühendisliği',
                'endustri': 'Endüstri Mühendisliği',
                'insaat': 'İnşaat Mühendisliği',
                'mimarlik': 'Mimarlık',
                'tip': 'Tıp',
                'dis': 'Diş Hekimliği',
                'eczacilik': 'Eczacılık',
                'hukuk': 'Hukuk',
                'iktisat': 'İktisat',
                'isletme': 'İşletme',
                'egitim': 'Eğitim Bilimleri',
                'fen': 'Fen-Edebiyat',
                'ilahiyat': 'İlahiyat',
                'iletisim': 'İletişim',
                'diger': 'Diğer'
            };

            // Seçilen bölümün tam adını al
            const selectedDepartment = userData?.department ? departments[userData.department] || userData.department : 'Bölüm Seçilmedi';
            
            // Mezuniyet yılı bilgisini al
            const graduationYear = userData?.graduationYear === 'mezun_degil' ? 'Henüz mezun değilim' : userData?.graduationYear || 'Belirtilmemiş';
            
            return {
                username: userData.username || username,
                email: userData.email || `${username}@firat.edu.tr`,
                phone: userData.phone || 'Belirtilmemiş',
                department: selectedDepartment,
                title: selectedDepartment !== 'Bölüm Seçilmedi' ? `${selectedDepartment} Öğrencisi` : 'Öğrenci',
                graduationYear: graduationYear,
                joinDate: new Date('2023-09-15').toISOString(),
                photo: userData.photo || '',
                bio: userData.bio || 'Henüz bir biyografi eklenmemiş.',
                interests: userData.interests || 'Henüz ilgi alanı eklenmemiş.',
                stats: {
                    posts: 128,
                    followers: 456,
                    following: 234
                },
                clubs: [
                    { name: 'Yazılım Kulübü', icon: 'fas fa-code' },
                    { name: 'Robotik Kulübü', icon: 'fas fa-robot' },
                    { name: 'Tasarım Kulübü', icon: 'fas fa-paint-brush' }
                ]
            };
        }

        // Profil fotoğrafı yükleme
        const profilePhoto = document.getElementById('profilePhotoPreview');
        const photoUploadOverlay = document.querySelector('.photo-upload-overlay');
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = 'image/*';
        fileInput.style.display = 'none';

        profilePhoto.parentElement.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    profilePhoto.style.backgroundImage = `url(${e.target.result})`;
                    profilePhoto.style.backgroundSize = 'cover';
                    profilePhoto.style.backgroundPosition = 'center';
                    
                    // Fotoğrafı localStorage'a kaydet
                    const userData = JSON.parse(localStorage.getItem('user') || '{}');
                    userData.photo = e.target.result;
                    localStorage.setItem('user', JSON.stringify(userData));
                };
                reader.readAsDataURL(file);
            }
        });

        // Sayfa yüklendiğinde profil fotoğrafını yükle
        document.addEventListener('DOMContentLoaded', () => {
            const userData = JSON.parse(localStorage.getItem('user') || '{}');
            if (userData.photo) {
                profilePhoto.style.backgroundImage = `url(${userData.photo})`;
                profilePhoto.style.backgroundSize = 'cover';
                profilePhoto.style.backgroundPosition = 'center';
            } else {
                profilePhoto.style.backgroundImage = 'none';
                profilePhoto.innerHTML = '<i class="fas fa-user"></i>';
            }
        });

        function loadUserData() {
            const userData = JSON.parse(localStorage.getItem('user')) || {};
            
            // Profil fotoğrafı ve gizlilik kontrolü
            const profilePhoto = document.querySelector('.profile-photo');
            if (userData.isPrivate) {
                // Gizlilik açık olduğunda tüm bilgileri gizle
                document.querySelector('.profile-name').textContent = 'Gizli Profil';
                document.querySelector('.profile-role').textContent = 'Bu profil gizli';
                document.querySelector('.profile-stats').style.display = 'none';
                document.querySelector('.sidebar-info').style.display = 'none';
                document.querySelector('.profile-details').style.display = 'none';
                document.querySelector('.new-post-card').style.display = 'none';
                document.querySelector('.post-card').style.display = 'none';
                
                // Hayalet fotoğrafı göster
                profilePhoto.classList.add('ghost');
                profilePhoto.innerHTML = '<i class="fas fa-ghost"></i>';
            } else if (userData.photo) {
                profilePhoto.style.backgroundImage = `url(${userData.photo})`;
                profilePhoto.style.backgroundSize = 'cover';
                profilePhoto.style.backgroundPosition = 'center';
            } else {
                profilePhoto.innerHTML = '<i class="fas fa-user"></i>';
            }
            
            // ... existing code ...
        }
    </script>
</body>
</html>